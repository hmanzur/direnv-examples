# Leer versiÃ³n desde .python-version (si existe)
if [ -f .python-version ]; then
  pyver=$(cat .python-version)
else
  pyver="system"
fi

# Usar layout python3 con la versiÃ³n leÃ­da
if [ "$pyver" = "system" ]; then
  layout python3
else
  layout python3 "$pyver"
fi

# Solo instalar dependencias si no se ha hecho antes
if [ ! -f .direnv/.bootstrapped ]; then
  echo "ðŸ”§ Instalando dependencias por primera vez..."
  pip install --upgrade pip
  pip install -r requirements.txt requirements-dev.txt
  # TambiÃ©n se pueden instalar herramientas de desarrollo manualmente en lugar de generar un archivo requirements-dev.txt
  # pip install pre-commit ansible-lint dotenv
  pre-commit install
  touch .direnv/.bootstrapped
fi

# Opcional: cargar variables desde .env
dotenv 2>/dev/null
